<!DOCTYPE html><html class="appearance-auto" lang="zh-Hans"><head><meta charset="UTF-8"><title>计算机系统三（二）——指令</title><meta name="description" content="ACM/acm/Acm/题解/算法/博客/blog"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="

MIPS寄存器

MIPS指令表









指令
示例
含义
注释




加法
add \\(s1,\\\)s2,\\(s3 | \\\)s1=\\(s2+\\\)s3




减法
sub \\(s1,\\\)s2,\\(s3 | \\\)s1=\\(s2-\\\)s3




立即数加法
addi \\(s1,\\\)s2,20
\$s1=\\(2+20 | | | 取字 | lw \\\)s1,20(\\(s2) | \\\)s1=memory[\$s2+20] | | | 存字 | sw \\(s1,20(\\\)s2) | memory[\$s2+20]=\\(s1 | | | 取半字 | lh \\\)s1,20(\\(s2) | memory[\\\)s2+20]=\\(s1 |.."><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="-xGeminix-" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">NeoRuTayE's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">计算机系统三（二）——指令</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3><h3 class="is-inline-block"><a href="/Love">🧸</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3><h3 class="is-inline-block"><a href="/Love">🧸</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#mips%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">MIPS寄存器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mips%E6%8C%87%E4%BB%A4%E8%A1%A8"><span class="toc-text">MIPS指令表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F"><span class="toc-text">三种指令格式</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E4%B8%89"><i class="tag post-item-tag">计算机系统三</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">计算机系统三（二）——指令</h1><time class="has-text-grey" datetime="2020-10-23T08:08:00.000Z">2020-10-23</time><article class="mt-2 post-content"><p><img src="https://pic.downk.cc/item/5f928ffc1cd1bbb86bf44e2f.jpg"></p>
<span id="more"></span>
<h4 id="mips寄存器">MIPS寄存器</h4>
<p><img src="https://pic.downk.cc/item/5f928fc01cd1bbb86bf44392.png"></p>
<h4 id="mips指令表">MIPS指令表</h4>
<table>
<colgroup>
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 24%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">指令</th>
<th style="text-align: center;">示例</th>
<th style="text-align: center;">含义</th>
<th style="text-align: center;">注释</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">加法</td>
<td style="text-align: center;">add \<span class="math inline">\(s1,\\\)</span>s2,\<span class="math inline">\(s3 | \\\)</span>s1=\<span class="math inline">\(s2+\\\)</span>s3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">减法</td>
<td style="text-align: center;">sub \<span class="math inline">\(s1,\\\)</span>s2,\<span class="math inline">\(s3 | \\\)</span>s1=\<span class="math inline">\(s2-\\\)</span>s3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">立即数加法</td>
<td style="text-align: center;">addi \<span class="math inline">\(s1,\\\)</span>s2,20</td>
<td style="text-align: center;">\$s1=\<span class="math inline">\(2+20 | | | 取字 | lw \\\)</span>s1,20(\<span class="math inline">\(s2) | \\\)</span>s1=memory[\$s2+20] | | | 存字 | sw \<span class="math inline">\(s1,20(\\\)</span>s2) | memory[\$s2+20]=\<span class="math inline">\(s1 | | | 取半字 | lh \\\)</span>s1,20(\<span class="math inline">\(s2) | memory[\\\)</span>s2+20]=\<span class="math inline">\(s1 | 从地址20(\\\)</span>s2)开始取半字（16biwordts）（h==halfword）</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">取无符号半字</td>
<td style="text-align: center;">lhu \<span class="math inline">\(s1,20(\\\)</span>s2)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">存半字</td>
<td style="text-align: center;">sh \<span class="math inline">\(s1,20(\$s2) | | | | 取字节 | lb \\\)</span>s1,20(\<span class="math inline">\(s2) | | | | 取无符号字节 | lbu \\\)</span>s1,20(\<span class="math inline">\(s2) | | | | 存字节 | sb \\\)</span>s1,20(\<span class="math inline">\(s2) | | | | 取链接字 | ll \\\)</span>s1,20($s2)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">是原子交换的前半部分</td>
</tr>
<tr class="even">
<td style="text-align: center;">存条件字</td>
<td style="text-align: center;">sc \<span class="math inline">\(s1,20(\\\)</span>s2)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">是原子交换的后半部分</td>
</tr>
<tr class="odd">
<td style="text-align: center;">取立即数的最高位</td>
<td style="text-align: center;">lui \<span class="math inline">\(s1,20 | \\\)</span>s1=20*2^{16}</td>
<td style="text-align: center;">取立即数并放到高16位</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">与</td>
<td style="text-align: center;">and \<span class="math inline">\(s1,\\\)</span>s2,\<span class="math inline">\(s3 | \\\)</span>s1=\<span class="math inline">\(s2 &amp; \\\)</span>s3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">或</td>
<td style="text-align: center;">or \<span class="math inline">\(s1,\\\)</span>s2,\<span class="math inline">\(s3 | \\\)</span>s1=\<span class="math inline">\(s2 bitor \\\)</span>s3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">或非</td>
<td style="text-align: center;">or \<span class="math inline">\(s1,\\\)</span>s2,\<span class="math inline">\(s3 | \\\)</span>s1=~(\<span class="math inline">\(s2 bitor \\\)</span>s3)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">立即数与</td>
<td style="text-align: center;">andi \<span class="math inline">\(s1,\\\)</span>s2,20</td>
<td style="text-align: center;">\<span class="math inline">\(s1=\\\)</span>s2 &amp; 20</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">立即数或</td>
<td style="text-align: center;">ori \<span class="math inline">\(s1,\\\)</span>s2,20</td>
<td style="text-align: center;">\<span class="math inline">\(s1=\\\)</span>s2 bitor 20</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">逻辑左移</td>
<td style="text-align: center;">sll \<span class="math inline">\(s1,\\\)</span>s2,10</td>
<td style="text-align: center;">\<span class="math inline">\(s1=\\\)</span>s2*4（左移两位）</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">逻辑右移</td>
<td style="text-align: center;">srl \<span class="math inline">\(s1,\\\)</span>s2,20</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">相等时跳转</td>
<td style="text-align: center;">beq \<span class="math inline">\(s1,\\\)</span>s2,25</td>
<td style="text-align: center;">if(\<span class="math inline">\(s1==\\\)</span>s2) goto PC+4+100</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">不相等时跳转</td>
<td style="text-align: center;">bne \<span class="math inline">\(s1,\\\)</span>s2,25</td>
<td style="text-align: center;">if(\$s1!=\<span class="math inline">\(2) goto PC+4+100 | | | 小于时置位 | slt \\\)</span>s1,\<span class="math inline">\(s2,\\\)</span>s3</td>
<td style="text-align: center;">if(\<span class="math inline">\(s2&lt;\\\)</span>s3) \<span class="math inline">\(s1=1 else \\\)</span>s1=0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">无符号数比较小于时置位</td>
<td style="text-align: center;">sltu \<span class="math inline">\(s1,\\\)</span>s2,\<span class="math inline">\(s3 | if(\\\)</span>s2&lt;\<span class="math inline">\(s3) \\\)</span>s1=1 else \<span class="math inline">\(s1=0 | 比较是否小于无符号数 | | 无符号数比较小于立即数时置位 | slti \\\)</span>s1,\<span class="math inline">\(s2,20 | if(\\\)</span>s2&lt;20) \<span class="math inline">\(s1=1 else \\\)</span>s1=0</td>
<td style="text-align: center;">比较是否小于常数</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">无符号数比较小于无符号数时置位</td>
<td style="text-align: center;">sltiu \<span class="math inline">\(s1,\\\)</span>s2,20</td>
<td style="text-align: center;">if(\<span class="math inline">\(s2&lt;20) \\\)</span>s1=1 else \<span class="math inline">\(s1=0 | 比较是否小于无符号常数 | | 跳转 | j 2500 | goto 10000 | 跳转到目标地址 | | 跳转到寄存器所指位置 | jr \\\)</span>ra</td>
<td style="text-align: center;">goto \$</td>
</tr>
<tr class="odd">
<td style="text-align: center;">跳转并链接</td>
<td style="text-align: center;">jal 2500</td>
<td style="text-align: center;">\$ra=PC+4; goto 10000</td>
<td style="text-align: center;">用于过程调用</td>
</tr>
</tbody>
</table>
<p><strong>MIPS32指令集文档：https://s3-eu-west-1.amazonaws.com/downloads-mips/documents/MD00086-2B-MIPS32BIS-AFP-6.06.pdf</strong></p>
<h4 id="三种指令格式">三种指令格式</h4>
<ul>
<li>R-型</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">op</th>
<th style="text-align: center;">rs</th>
<th style="text-align: center;">rt</th>
<th style="text-align: center;">rd</th>
<th style="text-align: center;">shamt</th>
<th style="text-align: center;">funct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">6bits</td>
<td style="text-align: center;">5bits</td>
<td style="text-align: center;">5bits</td>
<td style="text-align: center;">5bits</td>
<td style="text-align: center;">5bits</td>
<td style="text-align: center;">6bits</td>
</tr>
</tbody>
</table>
<p>其中：</p>
<ul>
<li>op：操作码</li>
<li>rs：第一个源寄存器编号</li>
<li>rt：第二个源寄存器编号</li>
<li>rd：destination目的寄存器编号</li>
<li>shamt：移位位数（00000表示不移位），仅在位移指令中使用</li>
<li>funct：功能码，用于选择op操作中的具体函数，如运算操作中的加法函数</li>
<li><p>R-型指令包括：add,sub,and,or,nor,slt,sltu,sll,srl,jr</p></li>
<li><p>I-型指令</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">op</th>
<th style="text-align: center;">rs</th>
<th style="text-align: center;">rt</th>
<th style="text-align: center;">constant or address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">6bits</td>
<td style="text-align: center;">5bits</td>
<td style="text-align: center;">5bits</td>
<td style="text-align: center;">16bits</td>
</tr>
</tbody>
</table>
<p>其中：</p>
<ul>
<li>op：操作码</li>
<li>rs：第一个源操作数寄存器号，参与运算使用</li>
<li>rt：第二个源操作数寄存器号，参与运算使用</li>
<li>16位立即数</li>
<li><p>I-型指令包括：addi,lw,sw,lh,sh,lb,sb,ll,sc,lui,andi,ori,beq,bne,slti,sltiu</p></li>
<li><p>J-型指令</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">op</th>
<th style="text-align: center;">address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">6bits</td>
<td style="text-align: center;">26bits</td>
</tr>
</tbody>
</table>
<ul>
<li>目标地址计算方法：dst=PC+4+address&lt;&lt;2（下一条指令的地址时当前PC加上4后，取最高的四位，再加上J型指令编码中的26位左移2位（×4）的结果）</li>
<li><p>J-型指令有：j, jr, jal</p></li>
<li><p>MIPS中的同步</p>
<ul>
<li><p>背景：处理器共享存储器同一区域，P1写，P2读。P1写的结果是P2要读的值，如果P1和P2不同步，将会发生数据竞争</p></li>
<li><p>解决方法：依赖硬件提供同步指令，即原子读/写内存操作</p></li>
<li><p>MIPS中靠ll和sc这两个指令实现同步</p>
<blockquote>
<p>LL 指令的功能是从内存中读取一个字，以实现接下来的 RMW（Read-Modify-Write） 操作；SC 指令的功能是向内存中写入一个字，以完成前面的 RMW 操作。LL/SC 指令的独特之处在于，它们不是一个简单的内存读取/写入的函数，当使用 LL 指令从内存中读取一个字之后，比如 LL d, off(b)，处理器会记住 LL 指令的这次操作（会在 CPU 的寄存器中设置一个不可见的 bit 位），同时 LL 指令读取的地址 off(b) 也会保存在处理器的寄存器中。接下来的 SC 指令，比如 SC t, off(b)，会检查上次 LL 指令执行后的 RMW 操作是否是原子操作（即不存在其它对这个地址的操作），如果是原子操作，则 t 的值将会被更新至内存中，同时 t 的值也会变为1，表示操作成功；反之，如果 RMW 的操作不是原子操作（即存在其它对这个地址的访问冲突），则 t 的值不会被更新至内存中，且 t 的值也会变为0，表示操作失败。</p>
</blockquote></li>
</ul></li>
</ul>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/10/04/%E5%93%88%E5%93%88%EF%BC%8C%E5%A5%BD%E4%B8%80%E4%B8%AA%E5%9B%BD%E5%BA%86%E5%87%BA%E8%A1%8C/" title="哈哈，好一个国庆出行"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: 哈哈，好一个国庆出行</span></a><a class="button is-default" href="/2020/10/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E4%B8%89%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%A6%82%E8%A6%81%E4%B8%8E%E6%8A%80%E6%9C%AF/" title="计算机系统三（一）——计算机概要与技术"><span class="has-text-weight-semibold">Next: 计算机系统三（一）——计算机概要与技术</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/Claudia-theme-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/haojen"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> NeoRuTayE 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>